<!-- HTML header for doxygen 1.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Centurion: Owners and Handles</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-fancy-scrollbars.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
<link href="centurion.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Centurion
   &#160;<span id="projectnumber">7.1.0</span>
   </div>
   <div id="projectbrief">A modern C++ wrapper library for SDL2</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('owners-and-handles.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Owners and Handles </div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#intro">Introduction</a></li>
<li class="level1"><a href="#terminology">Terminology</a></li>
<li class="level1"><a href="#syntax">Syntax</a></li>
<li class="level1"><a href="#examples">Examples</a></li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="intro"></a>
Introduction</h1>
<p >An important aspect of the Centurion library is the concept of owners and handles. Certain classes in the library come in two "flavours", where the difference is in their ownership semantics. For instance, you can default construct a <code>window</code> instance and don’t have to worry about memory management at all. Subsequently, you can create a <code>window_handle</code> from a raw pointer to a <code>SDL_Window</code> which won't manage the lifetime of the supplied pointer at all.</p>
<p >You can always create handles from owners, but you can't create owners from handles.</p>
<h1><a class="anchor" id="terminology"></a>
Terminology</h1>
<ul>
<li><b>Owner</b>: A version of a class with owning semantics, i.e. it manages the lifetime of its associated resources.</li>
<li><b>Handle</b>: A version of a class with non-owning semantics, i.e. it performs no resource management at all.</li>
</ul>
<h1><a class="anchor" id="syntax"></a>
Syntax</h1>
<p >In most cases, you'd want to use the owning versions of Centurion classes. As a result, owners feature the shorter and more obvious names, e.g. <code>window</code> is the owning version of <code>basic_window</code>. Subsequently, handles always feature a <code>_handle</code> suffix. So the handle version of <code>basic_window</code> is therefore <code>window_handle</code>.</p>
<h1><a class="anchor" id="examples"></a>
Examples</h1>
<p >In order to clarify this concept, let’s look at some examples.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;centurion.hpp&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Valid usage of an owning window, no need to worry about ownership and lifetimes</span></div>
<div class="line"><span class="keywordtype">void</span> basic_owning_window()</div>
<div class="line">{</div>
<div class="line">  <a class="code hl_class" href="classcen_1_1basic__window.html">cen::window</a> <a class="code hl_typedef" href="namespacecen.html#ad2eb382608242f24cf986eee93ea144c">window</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Do stuff...</span></div>
<div class="line"> </div>
<div class="line">} <span class="comment">// The window is destroyed</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Valid usage of an owning window along with a handle, handles don&#39;t claim ownership</span></div>
<div class="line"><span class="keywordtype">void</span> valid_handle_usage()</div>
<div class="line">{</div>
<div class="line">  <a class="code hl_class" href="classcen_1_1basic__window.html">cen::window</a> <a class="code hl_typedef" href="namespacecen.html#ad2eb382608242f24cf986eee93ea144c">window</a>;                 <span class="comment">// Creates an owning window</span></div>
<div class="line">  <a class="code hl_class" href="classcen_1_1basic__window.html">cen::window_handle</a> handle{<a class="code hl_typedef" href="namespacecen.html#ad2eb382608242f24cf986eee93ea144c">window</a>};  <span class="comment">// Creates a handle to an owning window</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Do stuff...</span></div>
<div class="line"> </div>
<div class="line">} <span class="comment">// The window is only destroyed once, since the handle is non-owning</span></div>
<div class="ttc" id="aclasscen_1_1basic__window_html"><div class="ttname"><a href="classcen_1_1basic__window.html">cen::basic_window</a></div><div class="ttdef"><b>Definition:</b> window.hpp:75</div></div>
<div class="ttc" id="anamespacecen_html_ad2eb382608242f24cf986eee93ea144c"><div class="ttname"><a href="namespacecen.html#ad2eb382608242f24cf986eee93ea144c">cen::window</a></div><div class="ttdeci">basic_window&lt; detail::owner_tag &gt; window</div><div class="ttdef"><b>Definition:</b> window.hpp:58</div></div>
</div><!-- fragment --><p >So what makes owners and handles so useful? Well, let's imagine a simple function like the following, which takes a non-owning pointer to an SDL struct, such as <code>SDL_Renderer</code>.</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> foo(SDL_Renderer* ptr)</div>
<div class="line">{</div>
<div class="line">  <span class="comment">// Fancy rendering...</span></div>
<div class="line">}</div>
</div><!-- fragment --><p >If our codebase features functions like the one in our example and we want to start using Centurion, we might not be able to immediately refactor all such functions in our codebase (there may be a lot of them). So we might be tempted to write something like the following.</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> foo(SDL_Renderer* ptr)</div>
<div class="line">{</div>
<div class="line">  <a class="code hl_class" href="classcen_1_1basic__renderer.html">cen::renderer</a> <a class="code hl_typedef" href="namespacecen.html#af6dbad20a46b69892b5e694a4069ae42">renderer</a>{ptr};  <span class="comment">// Claims ownership of the pointer!</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Fancier rendering...</span></div>
<div class="line"> </div>
<div class="line">} <span class="comment">// Oops, the renderer is deleted here!</span></div>
<div class="ttc" id="aclasscen_1_1basic__renderer_html"><div class="ttname"><a href="classcen_1_1basic__renderer.html">cen::basic_renderer</a></div><div class="ttdef"><b>Definition:</b> render.hpp:115</div></div>
<div class="ttc" id="anamespacecen_html_af6dbad20a46b69892b5e694a4069ae42"><div class="ttname"><a href="namespacecen.html#af6dbad20a46b69892b5e694a4069ae42">cen::renderer</a></div><div class="ttdeci">basic_renderer&lt; detail::owner_tag &gt; renderer</div><div class="ttdef"><b>Definition:</b> render.hpp:101</div></div>
</div><!-- fragment --><p >The problem with the above approach is that <b>we cannot supply a non-owning pointer to an owning Centurion component</b>. This is where handles come to the rescue! Handles are perfect for providing a <em>view</em> into the fancy Centurion APIs, without committing ownership of the associated resources. A correct version of the earlier example would look like the following.</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> foo(SDL_Renderer* ptr)</div>
<div class="line">{</div>
<div class="line">  <a class="code hl_class" href="classcen_1_1basic__renderer.html">cen::renderer_handle</a> handle{ptr};  <span class="comment">// Does not claim ownership of the pointer!</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Fancier rendering...</span></div>
<div class="line"> </div>
<div class="line">}  <span class="comment">// The SDL renderer is not deleted!</span></div>
</div><!-- fragment --><p >Furthermore, handles allow Centurion to provide wrappers for SDL functions that return non-owning raw pointers. For instance, one such function is <code>SDL_GetWindowFromID()</code>, which returns <code>SDL_Window*</code>. It would be impossible to safely wrap the returned pointers of such functions in Centurion components if we did not have the ability to explicitly specify the ownership semantics. Since we have handles, there is a Centurion function for the aforementioned SDL function, <code>get_window()</code>. There are many more examples of this throughout the library. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3 </li>
  </ul>
</div>
<script type="text/javascript">
    $(document).ready(function(){
        toggleButton = document.createElement('doxygen-awesome-dark-mode-toggle')
        toggleButton.title = "Toggle Light/Dark Mode"
        $(document).ready(function(){
          document.getElementById("MSearchBox").parentNode.appendChild(toggleButton)
        })
        $(window).resize(function(){
          document.getElementById("MSearchBox").parentNode.appendChild(toggleButton)
        })
    })
</script>
</body>
</html>
